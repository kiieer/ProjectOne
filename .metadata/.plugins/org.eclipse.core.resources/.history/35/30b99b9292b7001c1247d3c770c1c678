package com.revature.project.one.dao;


import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.revature.project.one.entities.Employee;
import com.revature.project.one.entities.Manager;
import com.revature.project.one.utils.ConnUtil;

public class EmpDAOPostgres implements EmpDAO {

	@Override
	public Employee login(Employee empObj) {
		// TODO Auto-generated method stub
		Employee localEmp = new Employee();
		Manager localMan = new Manager();
		try (Connection conn = ConnUtil.getInstance();) {
			PreparedStatement ptsmt = conn.prepareStatement("select * from employees");
			ResultSet rs = ptsmt.executeQuery();
			String eusername = empObj.getUsername();
			String epass = empObj.getPass();
			
			while(rs.next()) {
				int id = rs.getInt("id");
				String password = rs.getString("pass");
				String username = rs.getString("username");
				if (eusername.equals(username) && epass.equals(password)) {
					localEmp.setUsername(eusername);
					localEmp.setPass(epass); 
					} else if (localEmp == null) {
						ptsmt = conn.prepareStatement("select * from managers");
						rs = ptsmt.executeQuery();
						eusername = empObj.getUsername();
						epass = empObj.getPass();
						while(rs.next()) {
							id = rs.getInt("id");
							password = rs.getString("pass");
							username = rs.getString("username");
							if (eusername.equals(username) && epass.equals(password)) {
								localEmp.setUsername(eusername);
								localEmp.setPass(epass);
								break;
							}
						}
					}
			}
		} 
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return localEmp;
	}
	 
}
